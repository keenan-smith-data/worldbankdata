---
title: "Keras Regression"
author: "Keenan Smith"
format: html
editor: visual
---

## Quarto

Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <https://quarto.org>.

## Running Code

When you click the **Render** button a document will be generated that includes both content and the output of embedded code. You can embed code like this:

```{r}
1 + 1
```

You can add options to executable code like this

```{r Keras Regression, include=FALSE}
# Setting up the Basic Workflow for Lasso based on Silge
keras_workflow <-
  workflow() |>
  add_recipe(env_2010_rec)

# Finding Lambda based on 10 Fold CV
keras_grid <- tune_grid(
  keras_workflow |> add_model(lasso_spec),
  resamples = cv_folds_2010,
  grid = lambda_grid)

# A very Cool Graph Based on Silge Work
keras_grid |>
  collect_metrics() |>
  ggplot(aes(penalty, mean, color = .metric)) +
  geom_errorbar(aes(
    ymin = mean - std_err,
    ymax = mean + std_err
  ),
  alpha = 0.5
  ) +
  geom_line(size = 1.5) +
  facet_wrap(~.metric, scales = "free", nrow = 2) +
  scale_x_log10() +
  theme(legend.position = "none")

# Selecting Lambda based on the best RMSE value from the Tuned Grid
best_keras_accuracy <- keras_grid |>
  select_best("accuracy")

# Final Lasso Regression Workflow
final_keras <- finalize_workflow(
  keras_workflow |> add_model(keras_spec),
  best_keras_accuracy
)

# Regression Coefficient Path
final_keras |>
  fit(data = train_2010) |>
  extract_fit_engine() |>
  autoplot()

final_keras |>
  fit(data = train_2010) |>
  extract_fit_parsnip() |>
  tidy()

log_keras_2010 <- 
  final_keras %>% 
  fit_resamples(
    resamples = cv_folds_2010, 
    metrics = metric_set(
      recall, precision, f_meas, 
      accuracy, kap,
      roc_auc, sens, spec),
    control = control_resamples(
      save_pred = TRUE,
      extract = get_model)
    ) 
```

The `echo: false` option disables the printing of code (only output is displayed).
